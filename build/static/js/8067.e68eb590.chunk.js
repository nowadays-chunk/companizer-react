"use strict";(self.webpackChunktresorerie_management=self.webpackChunktresorerie_management||[]).push([[8067],{88255:(e,t,s)=>{s.d(t,{A:()=>E});var a=s(65043),n=s(96446),r=s(85865),l=s(60587),i=s(68903),c=s(12110),d=s(26494),o=s(63336),h=s(35721),x=s(37918),m=s(2050),u=s(48734),j=s(39336),g=s(41180),y=s(75748),p=s(87734),A=s(52185),f=s(6026),b=s(80379),v=s(70095),k=s(28791),S=s(87890),F=s(91281),N=s(17869),w=s(82291),D=s(51619),I=s(16851),B=s(42796),C=s(48304),M=s(70579);const $=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"],_=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),E=e=>{let{data:t=[],fieldsConfig:s,collectionName:E,modules:K=[]}=e;const O=(0,a.useMemo)((()=>{if(!t.length)return[];const e=Object.keys(s).filter((e=>"number"===s[e].type&&!e.includes("id")&&"unit_price"!==e));return s.unit_price&&e.push("unit_price"),e.map((e=>{const a=t.reduce(((t,s)=>t+(Number(s[e])||0)),0),n=a/t.length;return{key:e,label:s[e].label,sum:a,avg:n,min:Math.min(...t.map((t=>Number(t[e])||0))),max:Math.max(...t.map((t=>Number(t[e])||0)))}}))}),[t,s]),T=(0,a.useMemo)((()=>{if(!t.length)return[];return Object.keys(s).filter((e=>"select"===s[e].type)).map((e=>{const a=t.reduce(((t,s)=>{const a=s[e]||"Unknown";return t[a]=(t[a]||0)+1,t}),{});return{key:e,label:s[e].label,data:Object.keys(a).map((e=>({name:e,value:a[e]})))}}))}),[t,s]),R=(0,a.useMemo)((()=>{var e;if(!t.length)return[];const a=Object.keys(s).find((e=>"date"===s[e].type||"datetime"===s[e].type))||"created_at",n=t.reduce(((e,t)=>{let s=t[a];if(!s&&t.created_at&&(s=t.created_at),!s)return e;const n=new Date(s).toISOString().slice(0,7);return e[n]=(e[n]||0)+1,e}),{}),r=Object.keys(n).sort().map((e=>({date:e,count:n[e]})));return{label:`Trend over time (${(null===(e=s[a])||void 0===e?void 0:e.label)||"Date"})`,data:r}}),[t,s]),U=(0,a.useMemo)((()=>{if(!t.length)return["No data available to generate insights."];const e=[];return e.push(`Total ${t.length} records analyzed.`),O.forEach((t=>{e.push(`Total ${t.label}: ${t.key.includes("price")||t.key.includes("amount")?_(t.sum):t.sum.toLocaleString()}`)})),T.forEach((t=>{const s=t.data.sort(((e,t)=>t.value-e.value))[0];s&&e.push(`Most common ${t.label}: ${s.name} (${s.value} occurrences)`)})),e}),[t,O,T]);return t&&0!==t.length?(0,M.jsxs)(n.A,{sx:{flexGrow:1,p:3},children:[(0,M.jsx)(n.A,{display:"flex",alignItems:"center",mb:4,children:(0,M.jsxs)(r.A,{variant:"h4",component:"div",sx:{display:"flex",alignItems:"center",gap:2},children:[(0,M.jsx)(l.A,{sx:{bgcolor:"secondary.main"},children:(0,M.jsx)(I.A,{})}),"Analytics: ",E]})}),(0,M.jsxs)(i.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,M.jsx)(i.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,M.jsx)(c.A,{sx:{height:"100%",bgcolor:"#e3f2fd"},children:(0,M.jsxs)(d.A,{children:[(0,M.jsx)(r.A,{color:"textSecondary",gutterBottom:!0,children:"Total Records"}),(0,M.jsx)(r.A,{variant:"h4",children:t.length})]})})}),O.slice(0,3).map(((e,t)=>(0,M.jsx)(i.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,M.jsx)(c.A,{sx:{height:"100%"},children:(0,M.jsxs)(d.A,{children:[(0,M.jsxs)(r.A,{color:"textSecondary",gutterBottom:!0,children:[e.label," (Sum)"]}),(0,M.jsx)(r.A,{variant:"h4",sx:{color:"primary.main"},children:e.key.includes("price")||e.key.includes("cost")||e.key.includes("budget")?_(e.sum):e.sum.toLocaleString()}),(0,M.jsxs)(r.A,{variant:"caption",display:"block",children:["Avg: ",e.key.includes("price")?_(e.avg):e.avg.toFixed(2)]})]})})},t)))]}),(0,M.jsxs)(i.Ay,{container:!0,spacing:3,children:[(0,M.jsx)(i.Ay,{item:!0,xs:12,md:8,children:(0,M.jsxs)(o.A,{sx:{p:2,display:"flex",flexDirection:"column",height:400},children:[(0,M.jsx)(r.A,{variant:"h6",gutterBottom:!0,children:R.label}),(0,M.jsx)(g.u,{width:"100%",height:"100%",children:(0,M.jsxs)(y.b,{data:R.data,children:[(0,M.jsx)(p.d,{strokeDasharray:"3 3"}),(0,M.jsx)(A.W,{dataKey:"date"}),(0,M.jsx)(f.h,{}),(0,M.jsx)(b.m,{}),(0,M.jsx)(v.s,{}),(0,M.jsx)(k.N1,{type:"monotone",dataKey:"count",stroke:"#8884d8",activeDot:{r:8}})]})})]})}),(0,M.jsx)(i.Ay,{item:!0,xs:12,md:4,children:(0,M.jsxs)(o.A,{sx:{p:2,height:400,overflow:"auto",bgcolor:"#fff3e0"},children:[(0,M.jsxs)(r.A,{variant:"h6",gutterBottom:!0,display:"flex",alignItems:"center",gap:1,children:[(0,M.jsx)(B.A,{})," Key Insights"]}),(0,M.jsx)(h.A,{children:U.map(((e,t)=>(0,M.jsxs)(a.Fragment,{children:[(0,M.jsxs)(x.Ay,{children:[(0,M.jsx)(m.A,{children:(0,M.jsx)(C.A,{fontSize:"small"})}),(0,M.jsx)(u.A,{primary:e})]}),(0,M.jsx)(j.A,{component:"li"})]},t)))})]})}),T.map(((e,t)=>(0,M.jsx)(i.Ay,{item:!0,xs:12,md:6,lg:4,children:(0,M.jsxs)(o.A,{sx:{p:2,height:350,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,M.jsxs)(r.A,{variant:"h6",gutterBottom:!0,children:[e.label," Distribution"]}),(0,M.jsx)(g.u,{width:"100%",height:"100%",children:(0,M.jsxs)(S.r,{children:[(0,M.jsx)(F.Fq,{data:e.data,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,fill:"#8884d8",paddingAngle:5,dataKey:"value",label:!0,children:e.data.map(((e,t)=>(0,M.jsx)(N.f,{fill:$[t%$.length]},`cell-${t}`)))}),(0,M.jsx)(b.m,{}),(0,M.jsx)(v.s,{})]})})]})},t))),T.length>0&&O.length>0&&(0,M.jsx)(i.Ay,{item:!0,xs:12,children:(0,M.jsxs)(o.A,{sx:{p:2,height:400},children:[(0,M.jsxs)(r.A,{variant:"h6",gutterBottom:!0,children:[O[0].label," by ",T[0].label]}),(0,M.jsx)(g.u,{width:"100%",height:"100%",children:(0,M.jsxs)(w.E,{data:T[0].data,children:[(0,M.jsx)(p.d,{strokeDasharray:"3 3"}),(0,M.jsx)(A.W,{dataKey:"name"}),(0,M.jsx)(f.h,{}),(0,M.jsx)(b.m,{}),(0,M.jsx)(v.s,{}),(0,M.jsx)(D.yP,{dataKey:"value",fill:"#82ca9d",name:"Count"})]})})]})})]})]}):(0,M.jsx)(n.A,{p:3,children:(0,M.jsx)(r.A,{variant:"h6",color:"textSecondary",children:"No data available for analysis."})})}},8067:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var a=s(65043),n=s(96446),r=s(81637),l=s(85865),i=s(88255),c=s(92477),d=s(21256),o=s(70579);const h=()=>{const[e,t]=(0,a.useState)([]),[s,h]=(0,a.useState)(!0),[x,m]=(0,a.useState)(null),u=(0,a.useMemo)((()=>(0,d.h4)(c.collectionName)),[]);return(0,a.useEffect)((()=>{let e=!0;return u.fetchItems().then((s=>{e&&(t(s||[]),h(!1))})).catch((t=>{console.error("Error loading analysis data:",t),e&&(m("Failed to load data."),h(!1))})),()=>{e=!1}}),[u]),s?(0,o.jsx)(n.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh",children:(0,o.jsx)(r.A,{})}):x?(0,o.jsx)(l.A,{color:"error",variant:"h6",p:3,children:x}):(0,o.jsx)(i.A,{data:e,fieldsConfig:c.fieldsConfig,collectionName:c.collectionName})}}}]);
//# sourceMappingURL=8067.e68eb590.chunk.js.map